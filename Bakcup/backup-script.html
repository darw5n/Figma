<script>
 const pageNamesContainer = document.getElementById('page-names');

    function createPageNameInput(pageNumber) {
      const inputContainer = document.createElement('div');

      //pagetype
      const optionPage = ['Page', 'Separator', 'Section', 'Subpage'];
      const dropdown = document.createElement('select');

      for (let i = 0; i < optionPage.length; i++) {
        const option = document.createElement('option');
        option.text = optionPage[i];
        dropdown.add(option);
      }

      dropdown.id = `page-dropdown-${pageNumber}`;
      inputContainer.appendChild(dropdown);

      dropdown.addEventListener('change', () => {
        const selectedPage = dropdown.options[dropdown.selectedIndex].text;
        console.log('Nuovo valore selezionato:', selectedPage);
      });


      //emoji
      const emojiOptions = [' ', '🏁', '🏴‍☠️', '📝', '🕵️', '⏳', '🕹️', '🔽', '💡', '📌', '📐'];
      const dropdownEmoji = document.createElement('select');

      for (let i = 0; i < emojiOptions.length; i++) {
        const option = document.createElement('option');
        option.text = emojiOptions[i];
        dropdownEmoji.add(option);
      }

      dropdownEmoji.id = `page-emoji-dropdown-${pageNumber}`;
      inputContainer.appendChild(dropdownEmoji);

      dropdownEmoji.addEventListener('change', () => {
        const selectedEmoji = dropdownEmoji.options[dropdownEmoji.selectedIndex].text;
        console.log('Nuovo valore selezionato:', selectedEmoji);
      });
      //fine emoji



      const input = document.createElement('input');
      input.type = 'text';
      input.name = `page-${pageNumber}`;
      input.id = `page-name-input-${pageNumber}`;
      if (pageNumber === 1) {
        input.value = '🏁 cover';
        input.disabled = true;
        dropdownEmoji.value = emojiOptions[1];
        dropdownEmoji.disabled = true;
        dropdown.value = optionPage[1];
        dropdown.disabled = true;
      }
      inputContainer.appendChild(input);

      dropdown.addEventListener('change', () => {
        input.value = '';
        const selectedOption = dropdown.options[dropdown.selectedIndex].text;
        if (selectedOption === 'Separator') {
          input.value = '———————————————————————';
          input.disabled = true;
        } else {
          input.disabled = false;
          if (selectedOption === 'Section') {
            input.value = input.value.trim();
          }
        }
      });

      pageNamesContainer.appendChild(inputContainer);
    }



    function createPageNameInputs() {
      const numPagesInput = document.getElementById('num-pages');
      const numPages = parseInt(numPagesInput.value);
      const pageNameInputs = document.querySelectorAll('[id^="page-name-input-"]');

      // Calcola il numero di elementi già presenti nell'elenco
      const numExistingPages = pageNameInputs.length;

      // Aggiungi o rimuovi elementi se necessario
      if (numPages > numExistingPages) {
        for (let i = numExistingPages + 1; i <= numPages; i++) {
          createPageNameInput(i);
        }
      } else if (numPages < numExistingPages) {
        for (let i = numExistingPages; i > numPages; i--) {
          const inputContainer = document.querySelector(`#page-name-input-${i}`).parentNode;
          pageNamesContainer.removeChild(inputContainer);
        }
      }

      // Aggiorna il valore degli input esistenti se necessario
      pageNameInputs.forEach((input, i) => {
        const selectedOptions = document.getElementById(`page-dropdown-${i + 1}`).options[dropdown.selectedIndex].text;
        if (selectedOptions === 'Section') {
          input.value = input.value.trim();
        }
      });

      numPagesInput.value = numPages;
    }


    createPageNameInputs();

    document.getElementById('num-pages').addEventListener('change', createPageNameInputs);
    document.getElementById('create-pages-btn').addEventListener('click', () => {
      const numPages = document.getElementById('num-pages').value;
      const pageNames = [];
      const selectedOptions = [];
      const selectedEmojis = [];

      for (let i = 0; i < numPages; i++) {
        const pageTypeDropdown = document.getElementById(`page-dropdown-${i + 1}`);
        const pageNameInput = document.getElementById(`page-name-input-${i + 1}`);
        const pageNameDropdown = document.getElementById(`page-dropdown-${i + 1}`);
        const pageEmojiDropdown = document.getElementById(`page-emoji-dropdown-${i + 1}`);

        let pageName = pageNameInput.value.trim();
        const selectedOption = pageTypeDropdown.options[pageTypeDropdown.selectedIndex].text;

        if (selectedOption === 'Section') {
          pageName = '———  ' + pageName + '  ———';
        }

        pageNames.push(pageName);
        selectedOptions.push(selectedOption);
        selectedEmojis.push(pageEmojiDropdown.options[pageEmojiDropdown.selectedIndex].text);
      }

      // Invia un messaggio al plugin per creare le pagine con i nomi e le emoji specificate
      parent.postMessage({ pluginMessage: { type: 'create-pages', pageNames, selectedOptions, selectedEmojis } }, '*');
    });
</script>


<!--
2  version
-->

<script>
    const pageNamesContainer = document.getElementById('page-names');

    function createPageNameInput(pageNumber) {
      const inputContainer = document.createElement('div');

      //pagetype
      const optionPage = ['Page', 'Separator', 'Section', 'Subpage'];
      const dropdown = document.createElement('select');

      for (let i = 0; i < optionPage.length; i++) {
        const option = document.createElement('option');
        option.text = optionPage[i];
        dropdown.add(option);
      }

      dropdown.id = `page-dropdown-${pageNumber}`;
      inputContainer.appendChild(dropdown);

      dropdown.addEventListener('change', () => {
        const selectedPage = dropdown.options[dropdown.selectedIndex].text;
        console.log('Nuovo valore selezionato:', selectedPage);
      });


      //emoji
      const emojiOptions = [' ', '🏁', '🏴‍☠️', '📝', '🕵️', '⏳', '🕹️', '🔽', '💡', '📌', '📐'];
      const dropdownEmoji = document.createElement('select');

      for (let i = 0; i < emojiOptions.length; i++) {
        const option = document.createElement('option');
        option.text = emojiOptions[i];
        dropdownEmoji.add(option);
      }

      dropdownEmoji.id = `page-emoji-dropdown-${pageNumber}`;
      inputContainer.appendChild(dropdownEmoji);

      dropdownEmoji.addEventListener('change', () => {
        const selectedEmoji = dropdownEmoji.options[dropdownEmoji.selectedIndex].text;
        console.log('Nuovo valore selezionato:', selectedEmoji);
      });
      //fine emoji


      //imposto la prima pagina con elementi per la cover
      const input = document.createElement('input');
      input.type = 'text';
      input.name = `page-${pageNumber}`;
      input.id = `page-name-input-${pageNumber}`;
      if (pageNumber === 1) {
        input.value = '🏁 cover';
        input.disabled = true;
        dropdownEmoji.value = emojiOptions[1];
        dropdownEmoji.disabled = true;
        dropdown.value = optionPage[1];
        dropdown.disabled = true;
      }
      inputContainer.appendChild(input);
      //fine prima pagina

      dropdown.addEventListener('change', () => {
        input.value = '';
        const selectedOption = dropdown.options[dropdown.selectedIndex].text;
        if (selectedOption === 'Separator') {
          input.value = '———————————————————————';
          input.disabled = true;
        } else {
          input.disabled = false;
          if (selectedOption === 'Section') {
            input.value = input.value.trim();
          }
        }
      });

      pageNamesContainer.appendChild(inputContainer);
    }


    function createPageNameInputs() {
      const numPagesInput = document.getElementById('num-pages');
      const numPages = parseInt(numPagesInput.value);
      const pageNameInputs = document.querySelectorAll('[id^="page-name-input-"]');

      // Calcola il numero di elementi già presenti nell'elenco
      const numExistingPages = pageNameInputs.length;

      // Aggiungi o rimuovi elementi se necessario
      if (numPages > numExistingPages) {
        for (let i = numExistingPages + 1; i <= numPages; i++) {
          createPageNameInput(i);
        }
      } else if (numPages < numExistingPages) {
        for (let i = numExistingPages; i > numPages; i--) {
          const inputContainer = document.querySelector(`#page-name-input-${i}`).parentNode;
          pageNamesContainer.removeChild(inputContainer);
        }
      }

      // Aggiorna il valore degli input esistenti se necessario
      pageNameInputs.forEach((input, i) => {
        // const selectedOption = document.getElementById(`page-dropdown-${i + 1}`).options[dropdown.selectedIndex].text;
        const selectedOption = document.getElementById(`page-dropdown-${i + 1}`).options[document.getElementById(`page-dropdown-${i + 1}`).selectedIndex].text;
        if (selectedOption === 'Section') {
          input.value = input.value.trim();
        }
      });

      numPagesInput.value = numPages;
    }
    createPageNameInputs();

    
    document.getElementById('num-pages').addEventListener('change', createPageNameInputs);

    document.getElementById('create-pages-btn').addEventListener('click', () => {
      const numPages = document.getElementById('num-pages').value;
      const pageNames = [];
      const selectedOptions = [];
      const selectedEmojis = [];

      for (let i = 0; i < numPages; i++) {
        const dropdown = document.getElementById(`page-dropdown-${i + 1}`);
        const input = document.getElementById(`page-name-input-${i + 1}`);
        const dropdownEmoji = document.getElementById(`page-emoji-dropdown-${i + 1}`);

        let pageName = input.value.trim();
        let selectedOption = dropdown.options[dropdown.selectedIndex].text;
        let selectedEmoji = dropdownEmoji.options[dropdownEmoji.selectedIndex].text;


        if (selectedOption === 'Section') {
          pageName = '———  ' + pageName + '  ———';
        }
        pageNames.push(pageName);
        selectedOptions.push(selectedOption);
        selectedEmojis.push(selectedEmoji);
      }
      // Invia un messaggio al plugin per creare le pagine con i nomi specificati
      parent.postMessage({ pluginMessage: { type: 'create-pages', pageNames, selectedOptions, selectedEmojis } }, '*');
    });

    function inc(element) {
      let el = document.querySelector(`[name="${element}"]`);
      if (parseInt(el.value) < 15) {
      document.getElementById("plus").disabled = false;
      el.value = parseInt(el.value) + 1;
      createPageNameInputs(); // chiamare la funzione qui
      
      } else if (parseInt(el.value) === 15){
        document.getElementById("plus").disabled = true;
      }
    }
    function dec(element) {
      let el = document.querySelector(`[name="${element}"]`);
      if (parseInt(el.value) > 1 && parseInt(el.value) < 15) {
        el.value = parseInt(el.value) - 1;
        document.getElementById("plus").disabled = false;
        createPageNameInputs(); // chiamare la funzione qui
        
      } else{
        el.value = parseInt(el.value) - 1;
        createPageNameInputs(); // chiamare la funzione qui
      }
    }
  </script>


Puoi ottimizzare il codice?

Lo scopo è che al click sul pulsante "create-pages-btn", recuperi il numero pagine dal campo di input "num-pages" e salvi i valore di nomi, opzioni e emoji selezionate in tre array. 

Poi utilizzare un ciclo for per iterare su ciascuna pagina e recuperare i valori selezionati nei menu a discesa e nei campi di input corrispondenti.

Infine, la funzione invia un messaggio al plugin che contiene i nomi delle pagine, le opzioni e le emoji selezionate per creare le pagine con questi nomi, opzioni ed emoji. Infine, la funzione utilizza un altro ciclo for per registrare nel console i valori delle opzioni selezionate.